resource_types:
- name: slack-notifier
  type: registry-image
  source: {repository: mockersf/concourse-slack-notifier}
resources:
- name: repo
  type: git
  icon: github
  source:
    uri: https://github.com/concourse/ctop
- name: postgres-11
  type: registry-image
  icon: elephant
  source:
    repository: postgres
    tag: 11-alpine
- name: go-1.14
  type: registry-image
  icon: language-go
  source:
    repository: golang
    tag: 1.14
- name: notify
  type: slack-notifier
  icon: slack
  source:
    url: ((slack_hook))
    username: ((basic_auth.username))
    password: ((basic_auth.password))
    concourse_url: https://ci.concourse-ci.org
jobs:
- name: test
  plan:
  - get: repo
    trigger: true
  - get: postgres-11
    params: {format: oci}
  - get: go-1.14
    params: {format: oci}
  - task: test
    privileged: true
    file: repo/ci/test.yml
  on_failure:
    put: notify
    params:
      mode: normal
      alert_type: failed
